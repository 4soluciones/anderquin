{% load app_filters %}
{% if dictionary %}
<div class="card border-0 shadow-sm overflow-hidden roboto-condensed-regular" style="border-radius: 12px;">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-sm table-hover mb-0" id="table-dictionary" style="border-color: #bbdefb !important;">
                <thead>
                    <tr class="text-white text-uppercase small font-weight-bold" style="background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);">
                        <th class="border-0 py-2 text-center" style="width: 4%;">#</th>
                        <th class="border-0 py-2 text-center" style="width: 8%;">Documento</th>
                        <th class="border-0 py-2 text-center" style="width: 6%;">Serie</th>
                        <th class="border-0 py-2 text-center" style="width: 10%;">Número</th>
                        <th class="border-0 py-2 text-center" style="width: 9%;">Fecha</th>
                        <th class="border-0 py-2 text-center" style="width: 18%;">Cliente</th>
                        <th class="border-0 py-2 text-center" style="width: 10%;">DNI/RUC</th>
                        <th class="border-0 py-2 text-center" style="width: 10%;">Total</th>
                        <th class="border-0 py-2 text-center" style="width: 12%;">Usuario</th>
                        <th class="border-0 py-2 text-center" style="width: 10%;">Estado</th>
                        <th class="border-0 py-2 text-center" style="width: 5%;">Acción</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in dictionary %}
                    <tr pk="{{ p.id }}" pk2="{{ p.order_sale_quotation }}"
                        class="text-center align-middle {% if p.order_sale_quotation %}table-primary font-weight-bold{% endif %}"
                        style="font-size: 0.875rem;">
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.id }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.type }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.serial }}</td>
                        <td class="align-middle border-top font-weight-bold" style="border-color: #bbdefb !important; color: #0d47a1;">{{ p.correlative_sale|zfill:8 }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.create_at|date:"d-m-y" }}</td>
                        <td class="align-middle border-top text-left" style="border-color: #bbdefb !important;">{{ p.client|upper }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.client_nro }}</td>
                        <td class="align-middle border-top font-weight-bold text-success" style="border-color: #bbdefb !important;">{{ p.total|safe }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">{{ p.user.worker_set.last.employee.names|upper }}</td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">
                            {% if p.has_quotation_order == 'C' %}
                                <span class="badge badge-success px-2 py-1">Aprobada</span>
                            {% else %}
                                <span class="badge badge-secondary px-2 py-1">No aprobada</span>
                            {% endif %}
                        </td>
                        <td class="align-middle border-top" style="border-color: #bbdefb !important;">
                            <a class="btn btn-outline-success btn-sm border-2 btn-sales-rounded"
                               href="{% url 'sales:print_quotation' p.id 't'%}"
                               target="print"
                               title="Imprimir cotización">
                                <i class="fas fa-print"></i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<style>
    #table-dictionary tbody tr:hover { background-color: #e3f2fd !important; }
    .btn-sales-rounded { border-radius: 12px !important; }
</style>
{% else %}
<div class="alert alert-info border-0 shadow-sm" role="alert" style="border-radius: 12px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
    <div class="d-flex align-items-center">
        <i class="fas fa-info-circle fa-2x mr-3" style="color: #1565c0;"></i>
        <div>
            <strong>No hay cotizaciones</strong>
            <p class="mb-0 small">No se encontraron cotizaciones para el rango de fechas seleccionado.</p>
        </div>
    </div>
</div>
{% endif %}
