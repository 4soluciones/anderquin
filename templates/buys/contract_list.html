{% extends 'home.html' %}

{% block title %}
    Contratos
{% endblock title %}

{% block body %}

    <div class="container-fluid p-3 bg">
        <div class="card p-2">
            <div class="row">
                <div class="col-lg-2 pt-3 ml-3">
                    <button type="button" onclick="showModalView('modal_contract_create')"
                            class="btn btn-outline-success"><i class="fas fa-file-contract"></i>
                        NUEVO CONTRATO
                    </button>
                </div>
                <div class="col-lg-8 text-center pt-2">
                    <h2 class="font-weight-bold"> LISTADO DE CONTRATOS</h2>
                </div>
            </div>

            <div class="card-body p-2">
                <div id="client-grid-list">{% include "buys/contract_grid_list.html" %}</div>
            </div>
        </div>

        <div class="modal fade" id="modal-contract-create" tabindex="-1" role="dialog"
             aria-labelledby="ModalHelpTitle"
             aria-hidden="true"></div>
{#        <div class="modal fade" id="modal-contract-update" tabindex="-1" role="dialog"#}
{#             aria-labelledby="ModalHelpTitle"#}
{#             aria-hidden="true"></div>#}
    </div>
{% endblock body %}

{% block extrajs %}

    <script type="text/javascript">

        function showModalView(route) {
            $.ajax({
                url: '/buys/' + route + '/',
                dataType: 'json',
                type: 'GET',
                data: {'pk': 1},
                success: function (response) {
                    $('#modal-contract-create').html(response.form);
                    $('#modal-contract-create').modal('show');
                },
                fail: function (response) {
                    toastr.error('Error en la petición', '¡Mensaje!');
                }
            });
        }

        $(document).on('click', '#new-date', function () {
            $(".dates.main").after('<div class="row dates pt-2">' +
                '                       <div class="col-sm-10 col-md-10 col-lg-10 pl-1 pr-2">' +
                '                            <input type="date" class="form-control date-quota" id="date-quota" value="{{ date_now }}">' +
                '                       </div>' +
                '                       <div class="col-sm-2 col-md-2 col-lg-2 pl-0">' +
                '                                <button type="button" class="btn btn-outline-danger btn-block delete-row-address" >' +
                '                                    <i class="fas fa-minus"></i>' +
                '                                </button>' +
                '                       </div>' +
                '                     </div>');
        });
        $(document).on('click', '.delete-row-address', function () {
            $(this).parent('div').parent('div').remove();
        });

        $(document).on('click', '.item-oc', function () {
            let _detail_contract = $(this).attr('pk');

        });

    </script>
{% endblock extrajs %}